from datetime import datetime
from flask import Flask, Response, request
from flask_cors import CORS, cross_origin

app = Flask(__name__)
Cors = CORS(app)
CORS(app, resources={r'/*': {'origins': '*'}}, CORS_SUPPORTS_CREDENTIALS=True)
app.config['CORS_HEADERS'] = 'Content-Type'


@cross_origin
@app.route("/")
def hello_world():
    return "<p>Hello, World!</p>"


@cross_origin
@app.route('/jsessionid', methods=['POST', 'GET'])
def jsessionid():
    date = datetime.now().strftime("%d/%m/%Y %H:%M:%S")

    # Get the JSESSIONID cookie from the request
    sessionid = request.cookies.get('JSESSIONID')
    print(f"{date} - JSESSIONID: {sessionid}")

    response = Response(f"JSSESSIONID: {sessionid}")
    response.headers['Access-Control-Allow-Origin'] = 'http://localhost:8888'
    response.headers['Access-Control-Allow-Credentials'] = 'true'
    return response


if __name__ == "__main__":
    app.run()
